neo <- readDiscreteCharacterData("project691.neo.nex")
trans <- readDiscreteCharacterData("project691.trans.nex")
source("by_t_ki.Rev")


ppFile = "691_by_t_ki.pp"
power_p = powerPosterior(mymodel, monitors, moves, ppFile, cats = 25)
print("  - Created powerPosterior object")


power_p.burnin(generations = 10000, tuningInterval = 1000)
print("  - Commencing powerPosterior run")
power_p.run(generations = 1000)


ss = steppingStoneSampler(
  file = ppFile,
  powerColumnName = "power",
  likelihoodColumnName = "likelihood"
)
write(ss.marginal(), file = "691_by_t_ki.out.pp")
print("  Stepping stone marginal likelihood:")
ss.marginal()


ps = pathSampler(
  file = ppFile,
  powerColumnName = "power",
  likelihoodColumnName = "likelihood"
)
write(ss.marginal(), ps.marginal(), file = "691_by_t_ki.out.pp")
print("  Path sampler marginal likelihood:")
ps.marginal()


print("  # # # RUN COMPLETE # # #  ")
q()
